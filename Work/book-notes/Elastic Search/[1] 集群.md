### 分布式的特性

Elastic Search 天生就是分布式的，他隐藏了分布式的特性。**分片、负载均衡、冗余、路由、扩展**

### 集群的内部工作方式

Elasticsearch 认为真正的扩展应该是横向扩展（提升数量）而不是纵向扩展（提升质量）

集群 cluster：由一个或者多个节点构成，在集群中会有一个节点被选择为**主节点**

1. 集群健康度：red 部分主分片不可用   yellow 所有主分片可用  green 所有主分片及复制分片都可用
2. 索引（index）：[名词] 用以指向一个或多个分片的逻辑命名空间 logical namespace。用以存放数据的容器

节点 node ：一个 Elasticsearch 实例

1. 组成集群：启动另外的一个 es 实例，如果配置中的 cluster.name 相同，则会自动组件并加入集群
2. 扩展：es 会根据当前集群的情况，自动分配分片的存放。[ P0 P1 P2 ] [R0 R1 R2] -> [ P0 P1 ] [ P2 R0 ] [ R1 R2 ]

分片 shards：用以存储一个索引的分块单元

1. 主分片：能存储的数据大小是无限的，取决于你的硬盘大小（在创建索引时指定，不可变）
2. 副分片：主分片的副本，防止数据丢失并提供**读请求** （可变）

### 应对故障

当某节点掉线时，集群会检查各个分片的情况并修改集群健康度。

若主分片丢失则将副分片**升级**为主分片